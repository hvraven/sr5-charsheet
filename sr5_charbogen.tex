\documentclass[a4paper,xetex]{article}
\usepackage[%
    margin=0mm,
    centering,
]{geometry}
\setlength{\parindent}{0pt}
\pagestyle{empty}
\usepackage{hyperref}
\hypersetup{%
    pdfborder = {0 0 0}
}

\usepackage{xcolor}
\definecolor{border}{rgb}{0.494117647059,0.0588235294118,0.0705882352941}
\definecolor{line}{RGB}{109,110,112}
\definecolor{font}{RGB}{39,36,37}

\usepackage{fontspec}
\setmainfont[
    Ligatures=TeX,
    UprightFont={* Condensed Bold},
    ItalicFont={* Condensed Light Italic},
    BoldFont={* Condensed Bold},
%    BoldItalicFont={* Condensed Bold Oblique},
    ]{Open Sans}
\newfontfamily{\heading}
    [Ligatures=TeX]
    {Grishenko NBP}
\newfontfamily{\lightFont}[
    Ligatures=TeX,
    UprightFont={* Condensed Light},
    BoldFont={* Condensed Bold},
    ItalicFont={* Condensed Light Italic},
]{Open Sans}
\newcommand{\light}[1]{{\lightFont\color{line} #1}}

\usepackage{tikz}
\usetikzlibrary{fadings}
\usetikzlibrary{positioning}
\tikzset{%
    border/.style={draw=border, line width=.3mm},
    border end/.style={border, path fading=south},
    write/.style={draw=line, line width=.3mm},
}

\newcommand{\setnewlength}[2]{\newlength{#1}\setlength{#1}{#2}}

\usepackage{calc}
\newlength{\BoxWidth}
\newlength{\BoxSep}
\newlength{\TitleWidth}
\setlength{\BoxWidth}{95mm}
\setlength{\BoxSep}{3mm}

\setnewlength{\BoxInnerUpperMargin}{2mm}
\setnewlength{\BoxTitleHeight}{4.5mm}
\setnewlength{\BoxInnerInnerMargin}{4mm}
\setnewlength{\BoxInnerOuterMargin}{4mm}
\setnewlength{\VerticalBoxDistance}{5mm}
\setnewlength{\ContentWidth}{\BoxWidth-\BoxInnerInnerMargin-\BoxInnerOuterMargin}
\setnewlength{\LineDistance}{4.5mm}
\setnewlength{\LineGap}{3mm}

\newenvironment{CharSheet}{%
    \color{font}
}{%
}

\newenvironment{CharSheetPage}{%
    \begin{tikzpicture}%
    \path[use as bounding box]
        (-.5*\textwidth,0mm) rectangle (.5*\textwidth,.\textheight);
    \node[anchor=north west] at (-.5*\textwidth,0mm)
    {\includegraphics[width=.6\textwidth]{Shadowrun-5-Schriftzug_1500x300px.png}};
    \setlength{\LeftBoxStart}{-30mm}
    \setlength{\RightBoxStart}{-30mm}
}{%
    \node[above]  at (0mm, 10mm-\textheight) {\footnotesize
        \begin{tabular}{c}
            Shadowrun logo and content courtesy of Pegasus Games under
            license from Catalyst Game Labs and Topps Company, Inc.\\
            © 2014 Toppy Company, Inc. All rights reserved. Shadowrun is a
            registered trademark of Topps Company, Inc.
%            Shadowrun-Logo und Inhalte mit freundlicher Genehmigung von Pegasus
%            Spiele unter Lizenz von Catalyst Game Labs und Topps Company, Inc.\\
%            © 2014 Toppy Company, Inc. Alle Rechte vorbehalten. Shadowrun ist eine
%            eingetragene Handelsmarke von Topps Company, Inc.
        \end{tabular}};%
\end{tikzpicture}%
}

\newcommand{\BoxTitle}[1]{\heading \color{white} \MakeUppercase{#1}}
\newcommand{\DrawBoxTitleRight}[1]{% title
    \path[fill=border] (0mm,0mm) -- node[right] {\BoxTitle{#1}} ++(0mm,-\BoxTitleHeight)%
        -- ++(\TitleWidth,0mm) -- ++(7.5mm,0mm) -- ++(-7.5mm,\BoxTitleHeight) -- cycle (0mm,0mm);
}
\newcommand{\DrawBoxBorderRight}[1]{%height
    \path[border end] (0,-#1) -- ++(0mm,12mm)
        ++(\BoxWidth,0mm) -- ++(0mm,-12mm);
    \path[border] (0mm,0mm) -- ++(0mm,-#1+12mm) ++(\BoxWidth,0mm) --
        ++(0mm,#1-20.5mm) -- ++(-4mm,4mm) -- ++(-\BoxWidth+4mm,0mm);
}
\newcommand{\DrawBoxTitleLeft}[1]{% title
    \path[fill=border] (\BoxWidth,0mm) -- node[left] {\BoxTitle{#1}} ++(0mm,-\BoxTitleHeight)%
        -- ++(-\TitleWidth,0mm) -- ++(-7.5mm,0mm) --
        ++(7.5mm,\BoxTitleHeight) -- cycle (\BoxWidth,0mm);%
}
\newcommand{\DrawBoxBorderLeft}[1]{% height
    \path[border end] (\BoxWidth,-#1) -- ++(0mm,12mm) ++(-\BoxWidth,0mm) -- ++(0mm,-12mm);%
%    \path[border end] (-\BoxSep-\BoxWidth,#2-#3) -- ++(0mm,12mm);%
    \path[border] (\BoxWidth,0mm) -- ++(0mm,-#1+12mm) ++(-\BoxWidth,0mm) --
        ++(0mm,#1-20.5mm) -- ++(4mm,4mm) -- ++(\BoxWidth-4mm,0mm);
}

\newlength{\LeftBoxStart}
\newlength{\LeftBoxHeight}
\newlength{\RightBoxStart}
\newlength{\RightBoxHeight}
\newlength{\InBoxPosition}
\newenvironment{BoxLeft}[1]{%
    \begin{scope}[%
        xshift=-\BoxWidth-\BoxSep,
        yshift=\LeftBoxStart,
    ]
    \DrawBoxTitleLeft{#1}
    \setlength{\InBoxPosition}{-\BoxTitleHeight-\BoxInnerUpperMargin}
}{%
    \DrawBoxBorderLeft{-\InBoxPosition}
    \addtolength{\LeftBoxStart}{\InBoxPosition-\VerticalBoxDistance}
    \global\LeftBoxStart=\LeftBoxStart
    \end{scope}
}
\newenvironment{BoxRight}[1]{%
    \begin{scope}[%
        xshift=\BoxSep,
        yshift=\RightBoxStart,
    ]
    \DrawBoxTitleRight{#1}
    \setlength{\InBoxPosition}{-\BoxTitleHeight-\BoxInnerUpperMargin}
}{%
    \DrawBoxBorderRight{-\InBoxPosition}
    \addtolength{\RightBoxStart}{\InBoxPosition-\VerticalBoxDistance}
    \global\RightBoxStart=\RightBoxStart
    \end{scope}
}

\newenvironment{BoxRow}{%
}{%
    \addtolength{\InBoxPosition}{-\LineDistance}
    \global\InBoxPosition=\InBoxPosition
}

\newcommand{\Skip}[1]{\addtolength{\InBoxPosition}{-#1}\global\InBoxPosition=\InBoxPosition}

\newcommand{\SingleRow}[1]{#1 \Skip{\LineDistance}
}

\newcommand{\Line}[2]{% x, width
    \path[write] (\BoxInnerOuterMargin+#1, \InBoxPosition-\LineDistance) -- ++(#2,0mm);
}

\newcommand{\FullLine}{%
    \Line{0mm}{\ContentWidth}
}
\newcommand{\HalfLines}{%
    \Line{0mm}{.5*\ContentWidth-.5*\LineGap}
    \Line{.5*\ContentWidth+.5*\LineGap}{.5*\ContentWidth-.5*\LineGap}
}
\newcommand{\LabelAt}[3][right]{% x, label
    \node[base #1,inner sep=0pt] at (\BoxInnerOuterMargin+#2, \InBoxPosition-4mm)
        {\fontsize{7pt}{10.5pt}\selectfont #3};
}
\newcommand{\LabeledFullLine}[1]{%label
    \SingleRow{
        \FullLine
        \LabelAt{0mm}{#1}
    }
}
\newcommand{\EmptyFullLine}{%
    \SingleRow{\FullLine}
}

\setnewlength{\AttributeWidth}{15mm}
\newcommand{\Attribute}[2]{% x, attribute 
    \Line{#1}{\AttributeWidth}
    \Line{#1+\AttributeWidth+\LineGap}{.5*\ContentWidth-1.5*\LineGap-\AttributeWidth}
    \node[base left,inner sep=0pt] at (\BoxInnerOuterMargin+#1+\AttributeWidth, \InBoxPosition-4mm)
        {\fontsize{7pt}{10.5pt}\selectfont #2};
}
\newcommand{\AttributeLine}[2]{% left attribute, right attribute
    \SingleRow{%
        \Attribute{0mm}{#1}
        \Attribute{.5*\ContentWidth+.5*\LineGap}{#2}
    }
}

\begin{document}
\begin{CharSheet}
\begin{CharSheetPage}
    \setlength{\TitleWidth}{36mm}
    \begin{BoxLeft}{Personal Data}
        \LabeledFullLine{\textbf{NAME/PRIMARY ALIAS}}
        \begin{BoxRow}
            \FullLine
            \LabelAt{0mm}{Metatype}
            \LabelAt{.5*\ContentWidth}{Ethnicity}
        \end{BoxRow}
        \begin{BoxRow}
            \FullLine
            \LabelAt{0mm}{Age}
            \LabelAt{.25*\ContentWidth}{Sex}
            \LabelAt{.5*\ContentWidth}{Height}
            \LabelAt{.7*\ContentWidth}{Weight}
        \end{BoxRow}
        \begin{BoxRow}
            \FullLine
            \LabelAt{0mm}{Street Cred}
            \LabelAt{.35*\ContentWidth}{Notoriety}
            \LabelAt{.7*\ContentWidth}{Public awarness}
        \end{BoxRow}
        \begin{BoxRow}
            \FullLine
            \LabelAt{0mm}{Karma}
            \LabelAt{.25*\ContentWidth}{Total Karma}
            \LabelAt{.5*\ContentWidth}{Misc}
        \end{BoxRow}
    \end{BoxLeft}

    \setlength{\TitleWidth}{28mm}
    \begin{BoxLeft}{Attributes}
        \AttributeLine{Body}{Essence}
        \AttributeLine{Agility}{Magic/Resonance}
        \AttributeLine{Reaction}{Initiative}
        \AttributeLine{Strength}{Matrix Initiative}
        \AttributeLine{Willpower}{Astral Initiative}
        \AttributeLine{Logic}{Composure}
        \AttributeLine{Intuition}{Judge Intentions}
        \AttributeLine{Charisma}{Memory}
        \AttributeLine{Edge}{Lift/Carry}
        \AttributeLine{Edge Points}{Movement}
        \Skip{1.5mm}
        \begin{BoxRow}
            \FullLine
            \LabelAt{0mm}{Physical Limit:}
            \LabelAt{.33*\ContentWidth}{Mental Limit:}
            \LabelAt{.66*\ContentWidth}{Social Limit:}
        \end{BoxRow}
    \end{BoxLeft}

    \setlength{\TitleWidth}{18mm}
    \begin{BoxLeft}{Skills}
        \begin{BoxRow}
            \HalfLines
            \foreach \x in {0mm,.5*\ContentWidth+.5*\LineGap} {
                \LabelAt{\x}{Skill};
                \LabelAt{\x+31mm}{RTG};
                \LabelAt[left]{\x+.5*\ContentWidth-.5*\LineGap}{Type};
            }
        \end{BoxRow}
        \foreach \i in {1,...,19} {
            \begin{BoxRow}
                \HalfLines
                \foreach \x in {0mm,.5*\ContentWidth+.5*\LineGap}
                    \LabelAt[left]{\x+.5*\ContentWidth-.5*\LineGap}{\light{A/K}};
            \end{BoxRow}
        }
    \end{BoxLeft}

    \setlength{\TitleWidth}{70mm}
    \begin{BoxLeft}{IDs / Lifestyles / Currency}
        \LabeledFullLine{Primary Lifesyle}
        \begin{BoxRow}
            \FullLine
            \LabelAt{0mm}{Nuyen}
            \LabelAt{.5*\ContentWidth}{Licenses}
        \end{BoxRow}
        \LabeledFullLine{Fake IDs / Related Lifesyles / Funds / Licenses}
        \foreach \i in {1,...,6} \EmptyFullLine;
    \end{BoxLeft}

    \setlength{\TitleWidth}{50mm}
    \begin{BoxRight}{Core Combat Info}
        \begin{BoxRow}
            \FullLine
            \LabelAt{0mm}{Primary Armor}
            \LabelAt{60mm}{\light{Rating}}
        \end{BoxRow}
        \LabeledFullLine{Primary Ranged Weapon}
        \foreach \i/\l in {0/Dam,1/Acc,2/AP,3/Mode,4/RC,5/Ammo}
            \node[base right,inner sep=0pt] at
            (\BoxInnerOuterMargin+\i*.16*\ContentWidth, \InBoxPosition-2.5mm)
            {\fontsize{7pt}{10.5pt}\selectfont \light{\l}};
        \Skip{7mm}
        \LabeledFullLine{Primary Melee Weapon}
        \foreach \i/\l in {0/Reach,1/Dam,2/Acc,3/AP}
            \node[base right,inner sep=0pt] at
            (\BoxInnerOuterMargin+\i*.25*\ContentWidth, \InBoxPosition-2.5mm)
            {\fontsize{7pt}{10.5pt}\selectfont \light{\l}};
        \Skip{7mm}
    \end{BoxRight}
\end{CharSheetPage}
\end{CharSheet}
\end{document}
